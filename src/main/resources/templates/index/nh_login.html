<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"></meta>
    <link rel="stylesheet" th:href="@{/css/index.css}" />
    <title>农户登录</title>
</head>
<body>
<header>
    <div class="simple-header">
        <div class="desc">欢迎登录|<a href="#">注册</a></div>
    </div>
</header>
<section>
    <form class="register-form" id="loginForm">
        <div class="register-box">
            <label class="other_label">手 机 号 码
                <input name="nhTelephone" id="nhTelephone" minlength="11" maxlength="11" type="text" placeholder="您的手机号码"/>
            </label>
            <div class="tips">

            </div>
        </div>
        <div class="register-box">
            <label class="other_label">登 陆 密 码
                <input name="nhPassword" id="nhPassword" minlenth="6" maxlength="20" type="password" placeholder="建议至少使用两种字符组合"/>
            </label>
            <div class="tips">

            </div>
        </div>
        <div class="submit_btn">
            <button type="submit" id="submit_btn" onclick="register()">立 即 登 陆</button>
        </div>
    </form>
</section>
</body>
<script type="text/javascript" th:src="@{/libs/jquery-3.3.1.js}" ></script>
<script type="text/javascript" th:src="@{/js/index.js}"></script>
<script type="text/javascript" th:src="@{/libs/jquery-validation/jquery.validate.min.js}"></script>
<script type="text/javascript" th:src="@{/libs/jquery-validation/localization/messages_zh.min.js}"></script>
<script type="text/javascript" th:src="@{/libs/layer/layer.js}"></script>
<script type="text/javascript" th:src="@{/js/common.js}"></script>
<script type="text/javascript" th:src="@{/libs/md5.min.js}"></script>
<script>
    function register() {
        $("#loginForm").validate({
            submitHandler:function(form){
                var flag = loginClick();
                if(flag != false) {
                    nh_register();
                }
            }
        });
    }
    function nh_register() {
        showLoading();
        var inputPass = $("#nhPassword").val();
        var salt = password_salt;
        var str = "" + salt.charAt(0) + salt.charAt(2) + inputPass + salt.charAt(5) + salt;
        var password = md5(str);
        $.ajax({
            url:"/login//nh_login",
            type:"post",
            data:{
                nhTelephone:$('#nhTelephone').val(),
                nhPassword:password
            },
            success:function (data) {
                if(data.code == 0) {
                    layer.msg("登录成功");
                    window.location.href="/register/to_mj_register";
                } else {
                    layer.msg(data.msg);
                }
            },
            error:function (result) {

            }
        });
    }
</script>
</html>